# ADAD Experiment Configuration for ITW (In-the-Wild) Dataset
# Artifact-Detection-based Anomaly Detection for Deepfake Detection
#
# Training Strategy: Train on FAKE samples only to learn artifact patterns
# Testing: Evaluate on both REAL and FAKE samples
# Metrics: AUC, EER (score-based evaluation)

[EXP]
root = results_adad
name = exp_itw_adad
runs = 3
epochs = 50
save = True

[DATA]
# Train on fake samples only to learn artifact strength
databases = ['train_fake', 'dev', 'test']

# Training: FAKE samples only (artifact learning)
train_fake = ./data/itw/itw_train.csv
train_fake.type = csv
train_fake.absolute_path = True
train_fake.split_strategy = train
train_fake.filter = {'label': ['fake']}

# Development: Both real and fake
dev = ./data/itw/itw_dev.csv
dev.type = csv
dev.absolute_path = True
dev.split_strategy = train

# Testing: Both real and fake
test = ./data/itw/itw_test.csv
test.type = csv
test.absolute_path = True
test.split_strategy = test

# Target: binary classification (real=0, fake=1)
target = label
labels = ['real', 'fake']

[FEATS]
# Multi-stream features for ADAD
# wav2vec2 provides SSL embeddings (768 dims)
# Additional spectral/phase features needed for full ADAD
type = ['wav2vec2']
wav2vec2.model = facebook/wav2vec2-base
wav2vec2.layer = 12
scale = standard
save_features = True

[MODEL]
# ADAD: Artifact-Detection-based Anomaly Detection
type = adad
# MSE loss for artifact score regression
loss = mse
optimizer = adam
learning_rate = 0.0001
batch_size = 32
random_seed = 42

# ADAD architecture parameters
# Weighted fusion of streams
adad.fusion = weighted
# wav2vec2 embedding dimension
ssl_feat_dim = 768
time_steps = 128
spec_freq_dim = 64

# Training parameters
device = cuda                       # Use GPU if available

[PLOT]
# Score-based visualizations
best_model = True
figures = box, confusion, roc, eer

[EXPL]
# Enable interpretability analysis
plot_feature_importance = True
