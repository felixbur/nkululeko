# Experiment configuration for Fake-or-Real (FoR) 2-second dataset
# Using Artifact Detection Modules (ADM)
# Multi-stream approach: Time + Spectral + Phase artifact detection

[EXP]
root = results
name = exp_for2sec_adm
runs = 1
epochs = 50
save = True

[DATA]
# Using pre-defined train/dev/test splits from the dataset
databases = ['train', 'dev', 'test']

train = ./data/for-2sec/for-2sec_train.csv
train.type = csv
train.absolute_path = False
train.split_strategy = train

dev = ./data/for-2sec/for-2sec_dev.csv
dev.type = csv
dev.absolute_path = False
dev.split_strategy = train

test = ./data/for-2sec/for-2sec_test.csv
test.type = csv
test.absolute_path = False
test.split_strategy = test

# Target variable and class labels
target = label
labels = ['fake', 'real']

[FEATS]
# Multi-stream feature extraction for ADM
# 1. SSL features (wav2vec2) for TimeADM - temporal artifacts
# 2. Spectral features (SPTK fbank) for SpectralADM - spectral artifacts
# 3. Phase features (SPTK stft) for PhaseADM - phase-dynamics artifacts
# Using single SPTK extractor for both spectral and phase features
type = ['wav2vec2', 'sptk']
scale = standard
balancing = smote 

# SSL features configuration for TimeADM
wav2vec2.model = facebook/wav2vec2-base
wav2vec2.layer = 7

# SPTK features configuration for SpectralADM + PhaseADM
# fbank provides mel-filterbank features (spectral)
# stft provides magnitude/phase information (phase-dynamics)
sptk.features = ['fbank', 'stft']
sptk.fft_length = 512
sptk.frame_period = 160
sptk.frame_length = 400
sptk.n_channel = 80

[MODEL]
# ADM model: multi-stream artifact detection (Time + Spectral + Phase)
type = adm
measure = eer

# ADM architecture parameters (feature dimensions are inferred dynamically)
adm.fusion = weighted
adm.hidden_dim = 256

# Training parameters
learning_rate = 0.0001
optimizer = adam
batch_size = 32
loss = bce

[PLOT]
# Enable confusion matrix and performance visualizations
best_model = True
epoch_progression = True